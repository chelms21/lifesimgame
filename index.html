<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mii Town Simulator</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; background-color: #f4f4f9; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1, h2 { color: #333; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .currency { font-size: 1.5em; font-weight: bold; color: green; }
        
        /* Mii Card Styling */
        .mii-card { border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-bottom: 20px; background-color: #e9e9f9; display: flex; gap: 20px; }
        .mii-avatar { font-size: 4em; transition: transform 0.3s, opacity 0.3s, filter 0.3s; }
        .mii-avatar.sad { opacity: 0.7; }
        .mii-avatar.starving { animation: shake 0.5s infinite; }
        .mii-avatar.tired { filter: grayscale(50%); }
        .mii-avatar.sleeping { transform: rotateX(180deg); font-size: 3em; color: #666; }
        .mii-avatar.ill { color: #dc3545; animation: pulse 1s infinite; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25%, 75% { transform: translateX(-5px); } 50% { transform: translateX(5px); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        
        .stats { flex-grow: 1; }
        .stats-row { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 15px; }
        .stat-group { width: 150px; }
        .stat-group label { display: block; font-weight: bold; margin-bottom: 3px; }
        .bar-container { background-color: #ddd; height: 15px; border-radius: 5px; overflow: hidden; margin-top: 5px; }
        .stat-bar { height: 100%; transition: width 0.3s; }
        #happiness-bar { background-color: #ff69b4; }
        #happiness-bar.low { background-color: #cc0000; }
        #hunger-bar { background-color: #4CAF50; }
        #hunger-bar.low { background-color: #cc0000; }
        #energy-bar { background-color: #f7b731; } 
        #energy-bar.low { background-color: #cc0000; }
        
        /* Controls and Actions */
        .actions button, .controls button { padding: 10px 15px; margin-right: 10px; border: none; border-radius: 5px; cursor: pointer; color: white; font-weight: bold; transition: background-color 0.2s; margin-bottom: 5px;}
        .actions { margin-top: 10px; }
        #work-button { background-color: #007bff; }
        #sleep-button { background-color: #ff69b4; }
        .controls button { margin-bottom: 10px; }
        .controls #store-button { background-color: #28a745; }
        .controls #bank-button { background-color: #00bcd4; }
        .controls #investment-button { background-color: #ff8c00; }
        .controls #town-hall-button { background-color: #7b00d6; }
        .controls #party-button { background-color: #ff007f; }

        .inventory { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; }
        .item-slot { border: 1px solid #ddd; padding: 10px; border-radius: 5px; text-align: center; width: 120px; cursor: pointer; transition: background-color 0.2s; }
        .item-slot:hover { background-color: #f0f0f0; }
        
        /* Modals */
        .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 700px; border-radius: 10px; position: relative; }
        .close-button { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
        .close-button:hover, .close-button:focus { color: #000; text-decoration: none; cursor: pointer; }
        
        /* Sidebar/Resident List */
        .main-layout { display: flex; gap: 20px; }
        .main-content { flex: 3; }
        .sidebar { flex: 1; background-color: #f0f0f0; padding: 15px; border-radius: 8px; }
        .resident-mini-card { padding: 8px; border: 1px solid #ccc; margin-bottom: 5px; border-radius: 4px; cursor: pointer; transition: background-color 0.1s; }
        .resident-mini-card:hover { background-color: #e0e0e0; }
        .resident-mini-card.selected { background-color: #ffd700; border-color: gold; }
        .resident-mini-card.sad { background-color: #ffdddd; }
        .resident-mini-card.hungry { background-color: #ddffdd; }
        .resident-mini-card.asleep { background-color: #e9e9e9; opacity: 0.7; }
        .resident-mini-card.ill { background-color: #ffcccc; border: 2px solid red; }
        .resident-mini-card.child { background-color: #ccf2ff; }
        .resident-mini-card h5 { margin: 0 0 5px 0; font-size: 1em; }
        .resident-mini-card p { margin: 0; font-size: 0.8em; }
        .status-icon { margin-right: 5px; }

        /* Other UI */
        #mii-request-box { background-color: #fff3cd; border: 1px solid #ffeeba; padding: 10px; border-radius: 5px; margin-top: 15px; color: #856404; font-weight: bold; }
        .hidden { display: none !important; }
        #goals-box { background-color: #e6f7ff; border: 1px solid #91d5ff; padding: 10px; border-radius: 5px; margin-top: 15px; }
        .goal-item.completed { text-decoration: line-through; color: gray; }
    </style>
</head>
<body>

<div class="container">
    <div id="creation-screen" class="hidden">
        <h2>Welcome to Mii Town Simulator</h2>
        <p>Start by creating your first resident (Mii).</p>
        
        <div class="mii-creator-form">
            <label for="mii-name-input">Name:</label>
            <input type="text" id="mii-name-input" required><br><br>
            
            <label for="mii-gender-select">Gender:</label>
            <select id="mii-gender-select">
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select><br><br>

            <label for="mii-personality-select">Personality:</label>
            <select id="mii-personality-select">
                <option value="normal">Normal</option>
                <option value="stubborn">Stubborn</option>
                <option value="friendly">Friendly</option>
            </select><br><br>
            
            <button onclick="addMiiToTown()">Add Resident</button>
            <p>Current Residents: <span id="resident-count">0</span></p>
            <button id="start-town-button" onclick="startGame()" disabled>Start Town Life (Requires 1+ Mii)</button>
            
            <hr>
            <h3>Game Options</h3>
            <label for="game-mode-select">Game Mode:</label>
            <select id="game-mode-select">
                <option value="manual">Manual (Full Control)</option>
                <option value="automatic">Automatic (Miis take basic actions)</option>
            </select><br><br>
            
            <label for="game-difficulty-select">Difficulty:</label>
            <select id="game-difficulty-select">
                <option value="normal">Normal</option>
                <option value="easy">Easy (Caretaker Unlocked, Funds Boosted)</option>
            </select>
            
        </div>
    </div>

    <div id="game-screen" class="hidden">
        <div class="header">
            <h1 id="game-title-header">Maple Town</h1>
            <div>
                Town Money: <span class="currency">üí∞<span id="money-stat">0</span></span>
                <button onclick="resetGame()" style="background-color: #dc3545;">Reset Game</button>
            </div>
        </div>
        
        <div class="main-layout">
            
            <div class="main-content">
                <div class="controls">
                    <button id="add-mii-button" onclick="openNewMiiCreation()" style="background-color: #6f42c1;">+ Add New Mii</button>
                    <button id="store-button" onclick="openStore()">Maple Store üè™</button>
                    <button id="bank-button" onclick="openBankModal()">Bank üè¶</button>
                    <button id="investment-button" onclick="openInvestmentModal()">Investments üìà</button>
                    <button id="town-hall-button" onclick="openTownHall()">Town Hall üèõÔ∏è</button>
                    <button id="party-button" onclick="throwParty()">Throw Town Party! ü•≥</button>
                    <span style="display: block; margin-top: 5px;">Caretaker Status: <span id="caretaker-status"></span></span>
                </div>

                <h2>Current Resident:
                    <select id="mii-select" onchange="switchMii()">
                        </select>
                </h2>
                
                <div class="mii-card">
                    <div class="mii-visual">
                        <span class="mii-avatar">üòä</span>
                        <h3 id="mii-name">---</h3>
                    </div>

                    <div class="stats">
                        <div class="stats-row">
                            <div class="stat-group">
                                <label>Gender/Age:</label>
                                <span id="gender-stat">---</span>
                            </div>
                            <div class="stat-group">
                                <label>Personality/Skill:</label>
                                <span id="personality-stat">---</span>
                            </div>
                            <div class="stat-group">
                                <label>Relationship:</label>
                                <span id="relationship-stat">---</span>
                            </div>
                        </div>

                        <div class="stats-row">
                            <div class="stat-group">
                                <label>Happiness:</label>
                                <span id="happiness-stat">0</span>%
                                <div class="bar-container">
                                    <div id="happiness-bar" class="stat-bar"></div>
                                </div>
                            </div>
                            <div class="stat-group">
                                <label>Hunger:</label>
                                <span id="hunger-stat">0</span>%
                                <div class="bar-container">
                                    <div id="hunger-bar" class="stat-bar"></div>
                                </div>
                            </div>
                            <div class="stat-group">
                                <label>Energy:</label>
                                <span id="energy-stat">0</span>%
                                <div class="bar-container">
                                    <div id="energy-bar" class="stat-bar"></div>
                                </div>
                            </div>
                        </div>

                        <div id="mii-request-box" class="hidden">
                            Mii Request: I need a <span id="requested-item-name">---</span>!
                        </div>

                        <div class="actions">
                            </div>
                        <p id="mii-message">Select a Mii to begin.</p>
                        <p><small id="save-message">Game status will appear here.</small></p>
                    </div>
                </div>

                <div id="goals-box">
                    <h3>Seasonal Goals (Next check in <span id="season-ticks-remaining">---</span> ticks)</h3>
                    <ul id="goals-list">
                        </ul>
                </div>

                <h3>Town Inventory</h3>
                <div id="inventory-list" class="inventory">
                    </div>
            </div>

            <div class="sidebar">
                <h3>Town Residents</h3>
                <p>Current Season: <span id="current-season">---</span></p>
                <p>Active Event: <span id="active-event-status">None</span></p>
                <hr>
                <div id="resident-list">
                    </div>
            </div>

        </div>
    </div>
</div>

<div id="store-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeStore()">&times;</span>
        <h2>Maple Store</h2>
        <p>Town Funds: üí∞<span id="store-money">0</span></p>
        <div id="store-items" class="store-items">
            </div>
    </div>
</div>

<div id="town-hall-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeTownHall()">&times;</span>
        <h2 id="town-hall-title">Town Hall Status</h2>
        <div id="town-hall-content">
            </div>
    </div>
</div>

<div id="investment-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeInvestmentModal()">&times;</span>
        <h2>Town Investments</h2>
        <p>Total Invested: üí∞<span id="investment-total">0</span></p>
        <p>Passive Income per Tick: üí∞<span id="investment-rate">0</span></p>
        <hr>
        <label for="investment-amount">Amount to Invest (Min 10):</label>
        <input type="number" id="investment-amount" value="10" min="10"><br><br>
        <button onclick="makeInvestment()" style="background-color: #ff8c00;">Invest Funds</button>
    </div>
</div>

<div id="bank-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeBankModal()">&times;</span>
        <h2>Maple Town Bank</h2>
        <p>Current Town Money: üí∞<span id="bank-current-money">0</span></p>
        <p>Total Savings: üí∞<span id="savings-total">0</span> (1% interest per tick)</p>
        <hr>
        
        <h3>Deposit</h3>
        <label for="savings-deposit-amount">Amount to Deposit (Min 10):</label>
        <input type="number" id="savings-deposit-amount" value="10" min="10"><br><br>
        <button onclick="depositSavings()" style="background-color: #00bcd4;">Deposit</button>

        <h3 style="margin-top: 20px;">Withdraw</h3>
        <label for="savings-withdraw-amount">Amount to Withdraw (Min 10):</label>
        <input type="number" id="savings-withdraw-amount" value="10" min="10"><br><br>
        <button onclick="withdrawSavings()" style="background-color: #dc3545;">Withdraw</button>
    </div>
</div>

<div id="relationship-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeRelationshipModal()">&times;</span>
        <h2 id="rel-mii-name">---'s Relationships</h2>
        <p><strong>Status:</strong> <span id="rel-status">Single</span></p>
        <hr>
        
        <h3>Actions</h3>
        <div id="rel-actions">
            </div>

        <h3 style="margin-top: 20px;">Friends</h3>
        <ul id="rel-friends-ul">
            </ul>
    </div>
</div>

<div id="gift-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="giftModal.classList.add('hidden')">&times;</span>
        <h2>Gift Inventory to <span id="gift-target-name">---</span></h2>
        <p>Choose an item to give them. Higher cost items boost the Love Score more!</p>
        <div id="gift-inventory-list" class="inventory">
            </div>
    </div>
</div>

<div id="job-assignment-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeJobAssignmentModal()">&times;</span>
        <h2>Assign Job to <span id="job-mii-name">---</span></h2>
        <p>A job allows the Mii to generate passive income based on their skill (Max Skill: <span id="max-skill-display">100</span>).</p>
        <div id="job-list-options">
            </div>
    </div>
</div>

<div id="new-mii-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeNewMiiModal()">&times;</span>
        <h2>Add New Resident</h2>
        <label for="new-mii-name-input">Name:</label>
        <input type="text" id="new-mii-name-input" required><br><br>
        
        <label for="new-mii-gender-select">Gender:</label>
        <select id="new-mii-gender-select">
            <option value="male">Male</option>
            <option value="female">Female</option>
        </select><br><br>

        <label for="new-mii-personality-select">Personality:</label>
        <select id="new-mii-personality-select">
            <option value="normal">Normal</option>
            <option value="stubborn">Stubborn</option>
            <option value="friendly">Friendly</option>
        </select><br><br>
        
        <button onclick="addNewMii()">Move In!</button>
    </div>
</div>


<script src="script.js"></script>
</body>
</html>
