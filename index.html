<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mii Town Simulator</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; background-color: #f4f4f9; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1, h2 { color: #333; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .currency { font-size: 1.5em; font-weight: bold; color: green; }
        
        /* Mii Card Styling */
        .mii-card { border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-bottom: 20px; background-color: #e9e9f9; display: flex; gap: 20px; }
        .mii-avatar { font-size: 4em; transition: transform 0.3s, opacity 0.3s, filter 0.3s; }
        .mii-avatar.sad { opacity: 0.7; }
        .mii-avatar.starving { animation: shake 0.5s infinite; }
        .mii-avatar.tired { filter: grayscale(50%); }
        .mii-avatar.sleeping { transform: rotateX(180deg); font-size: 3em; color: #666; }
        .mii-avatar.ill { color: #dc3545; animation: pulse 1s infinite; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25%, 75% { transform: translateX(-5px); } 50% { transform: translateX(5px); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        
        .stats { flex-grow: 1; }
        .stats-row { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 15px; }
        .stat-group { width: 150px; }
        .stat-group label { display: block; font-weight: bold; margin-bottom: 3px; }
        .bar-container { background-color: #ddd; height: 15px; border-radius: 5px; overflow: hidden; margin-top: 5px; }
        .stat-bar { height: 100%; transition: width 0.3s; }
        #happiness-bar { background-color: #ff69b4; }
        #happiness-bar.low { background-color: #cc0000; }
        #hunger-bar { background-color: #4CAF50; }
        #hunger-bar.low { background-color: #cc0000; }
        #energy-bar { background-color: #f7b731; } 
        #energy-bar.low { background-color: #cc0000; }
        
        /* Controls and Actions */
        .actions button, .controls button { padding: 10px 15px; margin-right: 10px; border: none; border-radius: 5px; cursor: pointer; color: white; font-weight: bold; transition: background-color 0.2s; margin-bottom: 5px;}
        .actions { margin-top: 10px; }
        #work-button { background-color: #007bff; }
        #sleep-button { background-color: #ff69b4; }
        .controls button { margin-bottom: 10px; }
        .controls #store-button { background-color: #28a745; }
        .controls #bank-button { background-color: #00bcd4; }
        .controls #investment-button { background-color: #ff8c00; }
        .controls #town-hall-button { background-color: #7b00d6; }
        .controls #party-button { background-color: #ff007f; }

        .inventory { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; }
        .item-slot { border: 1px solid #ddd; padding: 10px; border-radius: 5px; text-align: center; width: 120px; cursor: pointer; transition: background-color 0.2s; }
        .item-slot:hover { background-color: #f0f0f0; }
        
        /* Modals */
        .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 700px; border-radius: 10px; position: relative; }
        .close-button { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
        .close-button:hover, .close-button:focus { color: #000; text-decoration: none; cursor: pointer; }
        
        /* Sidebar/Resident List */
        .main-layout { display: flex; gap: 20px; }
        .main-content { flex: 3; }
        .sidebar { flex: 1; background-color: #f0f0f0; padding: 15px; border-radius: 8px; }
        .resident-mini-card { padding: 8px; border: 1px solid #ccc; margin-bottom: 5px; border-radius: 4px; cursor: pointer; transition: background-color 0.1s; }
        .resident-mini-card:hover { background-color: #e0e0e0; }
        .resident-mini-card.selected { background-color: #ffd700; border-color: gold; }
        .resident-mini-card.sad { background-color: #ffdddd; }
        .resident-mini-card.hungry { background-color: #ddffdd; }
        .resident-mini-card.asleep { background-color: #e9e9e9; opacity: 0.7; }
        .resident-mini-card.ill { background-color: #ffcccc; border: 2px solid red; }
        .resident-mini-card.child { background-color: #ccf2ff; }
        .resident-mini-card h5 { margin: 0 0 5px 0; font-size: 1em; }
        .resident-mini-card p { margin: 0; font-size: 0.8em; }
        .status-icon { margin-right: 5px; }

        /* Other UI */
        #mii-request-box { background-color: #fff3cd; border: 1px solid #ffeeba; padding: 10px; border-radius: 5px; margin-top: 15px; color: #856404; font-weight: bold; }
        .hidden { display: none !important; }
        #goals-box { background-color: #e6f7ff; border: 1px solid #91d5ff; padding: 10px; border-radius: 5px; margin-top: 15px; }
        .goal-item.completed { text-decoration: line-through; color: gray; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ˜ï¸ Mii Town on Maple Island ğŸ˜ï¸</h1>
        
        <div id="creation-screen" class="screen">
            <h2>Start Your Town</h2>
            
            <label for="game-mode-select">Game Mode:</label>
            <select id="game-mode-select">
                <option value="manual">Manual âœ‹ (You manage everything)</option>
                <option value="automatic">Automatic ğŸ¤– (Miis act autonomously)</option>
            </select>

            <label for="game-difficulty-select">Difficulty:</label>
            <select id="game-difficulty-select">
                <option value="normal">Normal ğŸ˜… (Standard start)</option>
                <option value="easy">Easy ğŸ˜ (Start with Caretaker & extra cash)</option>
            </select>
            
            <hr>

            <h2>Create Your First Mii</h2>
            <p>You need at least one Mii to start your town.</p>
            <label for="mii-name-input">Mii Name:</label>
            <input type="text" id="mii-name-input" placeholder="e.g., Tom, Amy, Bob" maxlength="15">
            
            <label for="mii-gender-select">Gender:</label>
            <select id="mii-gender-select">
                <option value="male">Male â™‚ï¸</option>
                <option value="female">Female â™€ï¸</option>
            </select>
            
            <label for="mii-personality-select">Personality:</label>
            <select id="mii-personality-select">
                <option value="easygoing">Easygoing</option>
                <option value="energetic">Energetic</option>
                <option value="laid-back">Laid-back</option>
                <option value="stubborn">Stubborn</option>
            </select>
            
            <button onclick="addMiiToTown()">Add Mii to Town</button>
            <hr>
            <p>Current Residents: <span id="resident-count">0</span></p>
            <button onclick="startGame()" id="start-town-button" disabled>Start Town Life (Requires 1+ Mii)</button>
        </div>

        <div id="game-screen" class="screen hidden">
            
            <div class="town-status-bar">
                <p>ğŸ’° Money: <span id="money-stat">0</span></p>
                <button onclick="workForMoney()">ğŸ’¼ Work (+$10)</button>
                <button onclick="openInvestmentModal()">ğŸ“ˆ Invest</button>
                <button onclick="openBankModal()">ğŸ¦ Bank Savings</button>  <button onclick="throwParty()" id="party-button">ğŸ‰ Throw Party (ğŸ’°150)</button> </div>
            
            <div class="management-status">
                <p>Caretaker Status: 
                    <span id="caretaker-status"></span>
                </p>
            </div>

            <div class="resident-list-area">
                <h3>Town Residents</h3>
                <div id="resident-list" class="resident-grid">
                    </div>
            </div>

            <div class="mii-selector">
                <label for="mii-select">Select Mii to Interact:</label>
                <select id="mii-select" onchange="switchMii()"></select>
            </div>

            <div class="mii-card">
                <h2 id="mii-name"></h2>
                
                <div id="mii-request-box" class="request-box hidden">
                    <p>I want a <span id="requested-item-name"></span>!</p>
                </div>
                
                <div class="mii-avatar">
                    <div class="face">
                        <div class="eyes"></div>
                        <div class="mouth"></div>
                    </div>
                </div>
                
                <div class="stats">
                    <p>Gender: <span id="gender-stat"></span></p>
                    <p>Personality: <span id="personality-stat"></span></p>
                    <p>Relationship: <span id="relationship-stat">Single</span></p> 
                    
                    <p>â¤ï¸ Happiness: <span id="happiness-stat"></span></p>
                    <div class="bar-container"><div id="happiness-bar" class="stat-bar happy"></div></div>
                    
                    <p>ğŸ” Hunger: <span id="hunger-stat"></span></p>
                    <div class="bar-container"><div id="hunger-bar" class="stat-bar full"></div></div>
                </div>

                <div class="message-box">
                    <p id="mii-message"></p>
                </div>
            </div>

            <div class="actions">
                <button onclick="openStore()">ğŸ›’ Maple Store</button>
                <button onclick="openRelationshipModal()" id="relationship-button">â¤ï¸ Interact / Date</button>
                <button onclick="toggleSleep()" id="sleep-button">ğŸ›Œ Go to Sleep</button>
                <button onclick="openNewMiiCreation()">â• New Resident</button>
            </div>
            
            <div class="inventory-area">
                <h3>ğŸ’ Inventory (Click to use on selected Mii)</h3>
                <div id="inventory-list" class="inventory-grid">
                    </div>
            </div>

            <div class="save-area">
                <button onclick="saveGame()">ğŸ’¾ Save Game</button>
                <button onclick="resetGame()">ğŸ—‘ï¸ Reset Game</button>
                <p id="save-message" class="message-box"></p>
            </div>
        </div>
        
        <div id="store-modal" class="modal hidden">
            <div class="modal-content">
                <h2>ğŸ›’ Maple Store</h2>
                <p>Current Money: <span id="store-money">0</span></p>
                <div id="store-items" class="store-grid">
                    </div>
                <button onclick="closeStore()">Close Store</button>
            </div>
        </div>

        <div id="bank-modal" class="modal hidden">
            <div class="modal-content">
                <h2>ğŸ¦ Maple Town Bank</h2>
                <p>Current Money: ğŸ’°<span id="bank-current-money">0</span></p>
                <hr>
                <h3>Savings Account</h3>
                <p>Current Savings: ğŸ’°<span id="savings-total">0</span></p>
                <p>Interest Rate: **1% per tick** (Guaranteed Growth)</p>

                <label for="savings-deposit-amount">Amount to Deposit:</label>
                <input type="number" id="savings-deposit-amount" min="10" placeholder="Min 10 Gold">
                <button onclick="depositSavings()">Deposit</button>
                
                <hr>
                
                <label for="savings-withdraw-amount">Amount to Withdraw:</label>
                <input type="number" id="savings-withdraw-amount" min="10" placeholder="Min 10 Gold">
                <button onclick="withdrawSavings()">Withdraw</button>
                
                <button onclick="closeBankModal()">Close Bank</button>
            </div>
        </div>
        
        <div id="new-mii-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Create New Resident</h2>
                <label for="new-mii-name-input">Mii Name:</label>
                <input type="text" id="new-mii-name-input" placeholder="e.g., Jane, Alex" maxlength="15">
                
                <label for="new-mii-gender-select">Gender:</label>
                <select id="new-mii-gender-select">
                    <option value="male">Male â™‚ï¸</option>
                    <option value="female">Female â™€ï¸</option>
                </select>
                
                <label for="new-mii-personality-select">Personality:</label>
                <select id="new-mii-personality-select">
                    <option value="easygoing">Easygoing</option>
                    <option value="energetic">Energetic</option>
                    <option value="laid-back">Laid-back</option>
                    <option value="stubborn">Stubborn</option>
                </select>
                <button onclick="addNewMii()">Add to Town</button>
                <button onclick="closeNewMiiModal()">Cancel</button>
            </div>
        </div>

        <div id="investment-modal" class="modal hidden">
            <div class="modal-content">
                <h2>ğŸ“ˆ Town Investment Fund</h2>
                <p>Current Funds: ğŸ’°<span id="investment-total">0</span></p>
                <p>Passive Income: ğŸ’°<span id="investment-rate">0</span>/tick</p>

                <label for="investment-amount">Amount to Invest:</label>
                <input type="number" id="investment-amount" min="10" placeholder="Min 10 Gold">
                <p class="small-note">Note: Every ğŸ’°100 invested yields ğŸ’°1/tick passive income.</p>
                <button onclick="makeInvestment()">Invest Funds</button>
                <button onclick="closeInvestmentModal()">Close</button>
            </div>
        </div>

        <div id="relationship-modal" class="modal hidden">
            <div class="modal-content">
                <h2 id="rel-mii-name"></h2>
                <p>Current Relationship Status: <span id="rel-status"></span></p>
                
                <div id="rel-actions">
                    </div>
                
                <div id="rel-friendship-list" class="rel-list">
                    <h3>Friends:</h3>
                    <ul id="rel-friends-ul"></ul>
                </div>

                <button onclick="closeRelationshipModal()">Close</button>
            </div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
